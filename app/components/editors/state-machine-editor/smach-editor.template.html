<!-- build:css(.tmp) styles/esv/pynn-editor.css -->
<link rel="stylesheet" href="components/editors/state-machine-editor/smach-editor.style.css" />
<!-- endbuild -->

<div class="smach-editor-wrapper">
  <h3>SMACH State Machine Editor</h3>
  <div class="alert alert-info">
    <p>
      A <a target="_blank" href="http://wiki.ros.org/smach"><b>SMACH</b></a> 
      state machine controls the overall experiment. It can monitor the simulation properties published on 
      <a target="_blank" href="http://wiki.ros.org/Topics"><b>ROS topics</b></a> (e.g. simulation time, sensor output, spiking
      activity of brain) and publish on these topics or call 
      <a target="_blank" href="http://wiki.ros.org/Services"><b>ROS Services</b></a>. Get started with our
      <a target="_blank" href="{{platformDocumentationURL}}/nrp/tutorials/experiment/state_machines.html"><b>tutorial</b></a>.
    </p>
  </div>
  <div ng-show="stateMachines.length === 0" class="alert alert-info" role="alert">
    There is no SMACH script available for this experiment.
  </div>
  <hr>
  <div ng-include src="'components/editors/state-machine-editor/smach-editor-buttons.template.html'"></div>
  <div ng-repeat="stateMachine in stateMachines">
    <hr>
    <h4><code class="CodeMirror cm-s-default"><span class="cm-def">{{stateMachine.name}}</span></code></h4>
    <div ui-codemirror
         ui-codemirror-opts="editorOptions"
         ng-model="stateMachine.code"
         ui-refresh="stateMachine.code"
         ng-attr-id="state-machine-{{stateMachine.id}}"
         ng-change="onStateMachineChange(stateMachine)">
    </div>
    <div ng-repeat="(type, error) in stateMachine.error">
      <div class="alert alert-danger" role="alert">
        {{error.message}} <b>({{type}})</b>
      </div>
    </div>
    <button type="button" class="btn btn-default btn-md"
            owner-only
            ng-click="update(stateMachine)"
            ng-disabled="!stateMachine.dirty || stateService.statePending">
      <i class="glyphicon glyphicon-ok-circle"></i><span> Apply</span>
    </button>
    <button type="button" class="btn btn-default btn-md"
            owner-only
            ng-disabled="stateService.statePending"
            ng-click="delete(stateMachine)">
      <i class="glyphicon glyphicon-remove"></i><span> Delete</span>
    </button>
  </div>
  <hr>
  <div ng-show="stateMachines.length !== 0" ng-include src="'components/editors/state-machine-editor/smach-editor-buttons.template.html'" style="padding-bottom: 30px;"></div>
</div>
